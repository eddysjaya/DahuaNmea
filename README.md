# Dahua NMEA Recorder

Aplikasi Android untuk perekaman video dengan tracking GPS dalam format NMEA, didesain untuk perangkat Dahua MPT230 (Body Worn Camera).

## Fitur

- ✅ Perekaman video HD menggunakan Camera2 API
- ✅ Real-time GPS tracking dengan format NMEA 0183
- ✅ Sinkronisasi timestamp video dan GPS
- ✅ Antarmuka sederhana untuk layar 2.4" (240x320)
- ✅ Transfer file ke PC via USB
- ✅ Foreground service untuk recording yang stabil

## Spesifikasi

- **Target Android**: Android 11 (API 30)
- **Min Android**: Android 11 (API 30)
- **Resolusi**: 240x320 (2.4 inch)
- **Perangkat**: Dahua MPT230 Body Worn Camera
- **Format Video**: MP4 (H.264)
- **Format GPS**: NMEA 0183 (GPRMC, GPGGA)

## Struktur Proyek

```
app/
├── src/main/
│   ├── java/com/dahua/nmea/
│   │   ├── MainActivity.kt              # Activity utama
│   │   ├── service/
│   │   │   └── RecordingService.kt      # Service untuk recording
│   │   └── utils/
│   │       ├── GpsTracker.kt            # GPS tracking
│   │       ├── NmeaGenerator.kt         # Konversi ke format NMEA
│   │       ├── FileManager.kt           # Manajemen file
│   │       └── UsbTransferHelper.kt     # Helper USB transfer
│   ├── res/
│   │   ├── layout/
│   │   │   └── activity_main.xml        # Layout UI
│   │   ├── values/
│   │   │   ├── strings.xml              # String resources
│   │   │   ├── colors.xml               # Color resources
│   │   │   └── themes.xml               # Theme
│   │   └── xml/
│   │       └── file_paths.xml           # FileProvider config
│   └── AndroidManifest.xml              # Manifest dengan permissions
```

## Permissions

Aplikasi memerlukan izin berikut:
- **CAMERA**: Untuk perekaman video
- **RECORD_AUDIO**: Untuk audio pada video
- **ACCESS_FINE_LOCATION**: Untuk GPS tracking akurat
- **FOREGROUND_SERVICE**: Untuk service recording
- **USB_PERMISSION**: Untuk transfer file

## Cara Build

### Menggunakan Android Studio

1. Clone atau extract project
2. Buka project di Android Studio
3. Tunggu Gradle sync selesai
4. Hubungkan perangkat via USB atau gunakan emulator
5. Klik "Run" atau tekan Shift+F10

### Menggunakan Command Line

```bash
# Build debug APK
./gradlew assembleDebug

# Build release APK
./gradlew assembleRelease

# Install ke perangkat
./gradlew installDebug
```

APK akan tersedia di: `app/build/outputs/apk/`

## Cara Menggunakan

1. **Izinkan Permissions**: Saat pertama kali dibuka, izinkan semua permissions
2. **Tekan START**: Mulai perekaman video dan GPS tracking
3. **Tekan STOP**: Hentikan perekaman
4. **Transfer ke PC**:
   - Hubungkan perangkat ke PC via USB
   - Pilih mode "File Transfer" di notifikasi
   - Buka folder: `Internal Storage/Android/data/com.dahua.nmea/files/DahuaNmea/`
   - Copy folder `Videos` dan `NMEA` ke PC

## Format File Output

### Video
- **Lokasi**: `/DahuaNmea/Videos/`
- **Format**: VID_YYYYMMDD_HHMMSS.mp4
- **Codec**: H.264
- **Resolusi**: 640x480
- **Frame Rate**: 30fps

### NMEA
- **Lokasi**: `/DahuaNmea/NMEA/`
- **Format**: GPS_YYYYMMDD_HHMMSS.nmea
- **Standard**: NMEA 0183
- **Sentences**: GPRMC (Recommended Minimum), GPGGA (Fix Data)
- **Update Rate**: 1 Hz (1 detik)

### Contoh NMEA Output

```
# NMEA GPS Data
# Generated by Dahua NMEA Recorder
# Format: NMEA 0183
$GPRMC,123456.000,A,0630.1234,S,10645.6789,E,0.0,0.0,140126,,*6A
$GPGGA,123456.000,0630.1234,S,10645.6789,E,1,08,1.0,100.0,M,0.0,M,,*52
```

## Troubleshooting

### GPS tidak lock
- Pastikan berada di area terbuka
- Tunggu beberapa menit untuk cold start
- Pastikan permission lokasi diizinkan

### Video tidak terekam
- Periksa permission kamera dan audio
- Pastikan ada ruang storage cukup
- Restart aplikasi

### Tidak bisa transfer via USB
- Pastikan kabel USB support data transfer
- Pilih "File Transfer" bukan "Charging only"
- Install driver perangkat di PC jika diperlukan

## Dependencies

- AndroidX Core KTX
- AndroidX AppCompat
- Material Components
- CameraX (Camera2)
- Google Play Services Location
- Kotlin Coroutines

## Lisensi

Aplikasi ini dibuat untuk Dahua Technology.

## Kontak

Untuk pertanyaan dan dukungan, hubungi tim development Dahua.
